<div style="display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f8f9fa;">
  <p-card [style]="{ width: '800px', 'max-width': '100%' }">
    <ng-template pTemplate="header">
      <div style="text-align: center; padding: 2rem 0;">
        <i class="pi pi-user-plus" style="font-size: 3rem; color: #495057;"></i>
        <h2 style="margin-top: 1rem; margin-bottom: 0.5rem; color: #495057;">Create Account</h2>
        <p style="color: #6c757d; margin: 0;">Register for cafeteria membership</p>
      </div>
    </ng-template>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" autocomplete="off">
      <div class="p-fluid">
        <!-- Name -->
        <div class="p-field" style="margin-bottom: 1.5rem;">
          <label for="name" style="display: block; margin-bottom: 0.5rem;">
            Name <span class="p-error">*</span>
          </label>
          <input
            id="name"
            type="text"
            pInputText
            formControlName="name"
            placeholder="Full name"
            class="p-inputtext-lg"
            style="width: 100%;"
            autocomplete="off"
          />
          <small
            class="p-error"
            style="display: block; margin-top: 0.25rem;"
            *ngIf="f.name.touched && f.name.errors"
          >
            <span *ngIf="f.name.errors['required']">Name is required</span>
            <span *ngIf="f.name.errors['minlength']">Name must be at least 2 characters long</span>
            <span *ngIf="f.name.errors['pattern']">Name can only contain letters and spaces (numbers not allowed)</span>
          </small>
        </div>

        <!-- Username -->
        <div class="p-field" style="margin-bottom: 1.5rem;">
          <label for="username" style="display: block; margin-bottom: 0.5rem;">
            Username <span class="p-error">*</span>
          </label>
          <span class="p-input-icon-left">
            <i class="pi pi-user"></i>
            <input
              id="username"
              type="text"
              pInputText
              formControlName="username"
              placeholder="Choose a username"
              class="p-inputtext-lg"
              style="width: 100%;"
              autocomplete="off"
            />
          </span>
          <small
            class="p-error"
            style="display: block; margin-top: 0.25rem;"
            *ngIf="f.username.touched && f.username.errors"
          >
            <span *ngIf="f.username.errors['required']">Username is required</span>
            <span *ngIf="f.username.errors['pattern'] && !f.username.errors['required']"
              >Username must be 4-20 characters (letters, numbers, underscore _ and @ only)</span
            >
          </small>
        </div>

        <!-- Email -->
        <div class="p-field" style="margin-bottom: 1.5rem;">
          <label for="email" style="display: block; margin-bottom: 0.5rem;">
            Email <span class="p-error">*</span>
          </label>
          <input
            id="email"
            type="email"
            pInputText
            formControlName="email"
            placeholder="email@example.com"
            class="p-inputtext-lg"
            style="width: 100%;"
            autocomplete="off"
          />
          <small
            class="p-error"
            style="display: block; margin-top: 0.25rem;"
            *ngIf="f.email.touched && f.email.errors"
          >
            <span *ngIf="f.email.errors['required']">Email is required</span>
            <span *ngIf="f.email.errors['invalidEmail'] && !f.email.errors['required']">Please enter a valid email address</span>
            <span *ngIf="f.email.errors['invalidTld'] && !f.email.errors['required'] && !f.email.errors['invalidEmail']">Email must have a valid domain extension (e.g., .com, .org, .net)</span>
          </small>
        </div>

        <div class="p-field" style="margin-bottom: 1.5rem;">
          <label for="password" style="display: block; margin-bottom: 0.5rem;">
            Password <span class="p-error">*</span>
          </label>
          <p-password
            id="password"
            formControlName="password"
            [feedback]="true"
            [toggleMask]="true"
            placeholder="Create a password"
            styleClass="w-full"
            [inputStyle]="{ width: '100%' }"
            inputStyleClass="p-inputtext-lg"
            autocomplete="new-password"
          ></p-password>
          <small class="p-error" style="display: block; margin-top: 0.25rem;" *ngIf="f.password.touched && f.password.errors">
            <span *ngIf="f.password.errors['required']">Password is required</span>
            <span *ngIf="f.password.errors['minlength'] && !f.password.errors['required']">Password must be at least 8 characters long</span>
            <span *ngIf="f.password.errors['pattern'] && !f.password.errors['required'] && !f.password.errors['minlength']">Password must include at least one uppercase letter, one lowercase letter, one number, and one special character (@$!%*?&)</span>
          </small>
        </div>

        <div class="p-field" style="margin-bottom: 1.5rem;">
          <label for="confirmPassword" style="display: block; margin-bottom: 0.5rem;">
            Confirm Password <span class="p-error">*</span>
          </label>
          <p-password
            id="confirmPassword"
            formControlName="confirmPassword"
            [feedback]="false"
            [toggleMask]="true"
            placeholder="Re-enter password"
            styleClass="w-full"
            [inputStyle]="{ width: '100%' }"
            inputStyleClass="p-inputtext-lg"
            autocomplete="new-password"
          ></p-password>
          <small class="p-error" style="display: block; margin-top: 0.25rem;" *ngIf="(f.confirmPassword.touched && f.confirmPassword.errors) || (registerForm.errors?.['mismatch'] && (f.confirmPassword.touched || f.password.touched))">
            <span *ngIf="f.confirmPassword.errors?.['required']">Confirm password is required</span>
            <span *ngIf="registerForm.errors?.['mismatch'] && !f.confirmPassword.errors?.['required']">Passwords do not match. Please re-enter the same password</span>
          </small>
        </div>

        <p-message 
          *ngIf="errorMessage" 
          severity="error" 
          [text]="errorMessage"
          [style]="{ width: '100%', 'margin-bottom': '1rem' }"
        ></p-message>

        <p-message 
          *ngIf="successMessage" 
          severity="success" 
          [text]="successMessage"
          [style]="{ width: '100%', 'margin-bottom': '1rem' }"
        ></p-message>

        <button
          pButton
          type="submit"
          label="Create Account"
          icon="pi pi-user-plus"
          [loading]="loading"
          class="p-button-lg p-button-success"
          style="width: 100%; margin-bottom: 1rem;"
        ></button>

        <div style="text-align: center; padding-top: 1rem; border-top: 1px solid #dee2e6;">
          <p style="color: #6c757d; margin-bottom: 0.5rem;">Already have an account?</p>
          <button
            pButton
            type="button"
            label="Sign In"
            icon="pi pi-sign-in"
            class="p-button-text"
            (click)="goToLogin()"
          ></button>
        </div>
      </div>
    </form>
  </p-card>
</div>
